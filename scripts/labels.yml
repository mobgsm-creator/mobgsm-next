# Traefik
traefik.enable=true
traefik.http.middlewares.gzip.compress=true
traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https

# Service definition
traefik.http.services.mobgsm-service.loadbalancer.server.port=3000

# HTTPS router
traefik.http.routers.mobgsm-https.rule=HostRegexp(`^([a-zA-Z0-9-]+\.)?mobgsm\.com$`)
traefik.http.routers.mobgsm-https.entryPoints=https
traefik.http.routers.mobgsm-https.middlewares=gzip
traefik.http.routers.mobgsm-https.service=mobgsm-service
traefik.http.routers.mobgsm-https.tls=true
traefik.http.routers.mobgsm-https.tls.certresolver=letsencrypt

# HTTP router (redirect)
traefik.http.routers.mobgsm-http.rule=HostRegexp(`^([a-zA-Z0-9-]+\.)?mobgsm\.com$`)
traefik.http.routers.mobgsm-http.entryPoints=http
traefik.http.routers.mobgsm-http.middlewares=redirect-to-https
traefik.http.routers.mobgsm-http.service=mobgsm-service

# Caddy
caddy_0.encode=zstd,gzip
caddy_0.handle_path.0_reverse_proxy={{upstreams 3000}}
caddy_0.handle_path=/*
caddy_0.header=-Server
caddy_0.try_files={path} /index.html /index.php
caddy_0=http://mobgsm-service
caddy_ingress_network=coolify
